#include "stdafx.h"
#include ".\initdlgprocalbumwizard.h"
#include "albumWizard.h"
#include "objet.h"

////////////////////////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////////////////////////
CInitDlgProcAlbumWizard::CInitDlgProcAlbumWizard(void)
{
	m_cAlbumWizard = NULL;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////////////////////////
CInitDlgProcAlbumWizard::~CInitDlgProcAlbumWizard(void)
{
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////////////////////////
LRESULT CInitDlgProcAlbumWizard::OnInitDialog(HWND hwndDlg, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
	LOGFONT lf;
	memset(&lf, 0, sizeof(LOGFONT));
	HDC hdc = ::GetDC(NULL);
	lf.lfHeight = -11 * GetDeviceCaps(hdc, LOGPIXELSY) / 72;
	::ReleaseDC(NULL, hdc);
	lf.lfWeight = FW_SEMIBOLD;
	HFONT hFont = CreateFontIndirect(&lf);
	SendDlgItemMessage(hwndDlg, IDC_STTITRE, WM_SETFONT , (WPARAM)m_cAlbumWizard->GetTitleFont(), (LPARAM)0);
	CObjet::CenterWindow(GetParent(hwndDlg));
	return 0;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////////////////////////
LRESULT CInitDlgProcAlbumWizard::OnCommand(HWND hwndDlg, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
	PropSheet_SetWizButtons(GetParent(hwndDlg), PSWIZB_NEXT | PSWIZB_FINISH);
	return 0;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////////////////////////
LRESULT CInitDlgProcAlbumWizard::OnNotify(HWND hwndDlg, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
	LPNMHDR lpnm = (LPNMHDR) lParam;

	switch (lpnm->code)
		{
		case PSN_SETACTIVE : //Enable the appropriate buttons.
			PropSheet_SetWizButtons(GetParent(hwndDlg), PSWIZB_NEXT | PSWIZB_FINISH);
			CObjet::CenterWindow(GetParent(hwndDlg));
			break;

		case PSN_WIZNEXT :
			break;

		case PSN_WIZFINISH :
			break;

		default :
			break;
		}
	return 0;
}